{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar _a;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ContractKitProvider = exports.ContextProvider = exports.useContractKitContext = void 0;\n\nvar contractkit_1 = require(\"@celo/contractkit\");\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar connectors_1 = require(\"./connectors\");\n\nvar constants_1 = require(\"./constants\");\n\nvar contract_kit_reducer_1 = require(\"./contract-kit-reducer\");\n\nvar modals_1 = require(\"./modals\");\n\nvar use_contract_kit_methods_1 = require(\"./use-contract-kit-methods\");\n\nvar helpers_1 = require(\"./utils/helpers\");\n\nvar useIsMounted_1 = require(\"./utils/useIsMounted\");\n\nvar initialState = {\n  connector: new connectors_1.UnauthenticatedConnector(constants_1.Mainnet),\n  connectorInitError: null,\n  dapp: {\n    name: 'Celo dApp',\n    description: 'Celo dApp',\n    url: 'https://celo.org',\n    icon: 'https://celo.org/favicon.ico'\n  },\n  network: constants_1.Mainnet,\n  networks: constants_1.DEFAULT_NETWORKS,\n  pendingActionCount: 0,\n  address: null,\n  connectionCallback: null,\n  feeCurrency: contractkit_1.CeloContract.GoldToken\n};\nexports.useContractKitContext = (_a = __read(createContractKitContext(), 2), _a[0]), exports.ContextProvider = _a[1]; // This makes it so we don't have to provide defaults for our context\n// and also so that if our hooks are used outside of the Provider it\n// will throw an error.\n\nfunction createContractKitContext() {\n  var contractKitContext = react_1.default.createContext(undefined);\n\n  var useCtx = function () {\n    var c = react_1.default.useContext(contractKitContext);\n    if (!c) throw new Error('Components using the use-contractkit hook must be a child of a ContractKitProvider');\n    return c;\n  };\n\n  return [useCtx, contractKitContext.Provider];\n}\n\nvar ContractKitProvider = function (_a) {\n  var _b;\n\n  var children = _a.children,\n      connectModal = _a.connectModal,\n      actionModal = _a.actionModal,\n      dapp = _a.dapp,\n      _c = _a.network,\n      network = _c === void 0 ? constants_1.Mainnet : _c,\n      _d = _a.networks,\n      networks = _d === void 0 ? constants_1.DEFAULT_NETWORKS : _d,\n      _e = _a.feeCurrency,\n      feeCurrency = _e === void 0 ? contractkit_1.CeloContract.GoldToken : _e;\n  var isMountedRef = (0, useIsMounted_1.useIsMounted)();\n  var previousConfig = (0, react_1.useMemo)(function () {\n    return (0, helpers_1.loadPreviousConfig)(network);\n  }, [network]);\n\n  var _f = __read((0, react_1.useReducer)(contract_kit_reducer_1.contractKitReducer, __assign(__assign(__assign({}, initialState), previousConfig), {\n    network: previousConfig.network || network,\n    networks: networks,\n    feeCurrency: feeCurrency,\n    dapp: __assign(__assign({}, dapp), {\n      icon: (_b = dapp.icon) !== null && _b !== void 0 ? _b : \"\".concat(dapp.url, \"/favicon.ico\")\n    })\n  })), 2),\n      state = _f[0],\n      _dispatch = _f[1];\n\n  var dispatch = (0, react_1.useCallback)(function (type) {\n    var payload = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      payload[_i - 1] = arguments[_i];\n    }\n\n    if (isMountedRef.current) {\n      _dispatch({\n        type: type,\n        payload: payload[0]\n      });\n    }\n  }, [isMountedRef]);\n  var methods = (0, use_contract_kit_methods_1.useContractKitMethods)(state, dispatch);\n  (0, react_1.useEffect)(function () {\n    if (connectors_1.CONNECTOR_TYPES[state.connector.type] !== connectors_1.UnauthenticatedConnector) {\n      methods.initConnector(state.connector).catch(function () {\n        // If the connector fails to initialise on mount then we reset.\n        dispatch('destroy');\n      });\n    }\n    /* eslint-disable */\n    // We only want this to run on mount so the deps array is empty.\n\n  }, []);\n  /* eslint-enable */\n\n  return react_1.default.createElement(exports.ContextProvider, {\n    value: [state, dispatch, methods]\n  }, react_1.default.createElement(modals_1.ConnectModal, __assign({}, connectModal)), react_1.default.createElement(modals_1.ActionModal, __assign({}, actionModal)), children);\n};\n\nexports.ContractKitProvider = ContractKitProvider;","map":{"version":3,"sources":["../src/contract-kit-provider.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ContractKitProvider = exports.ContextProvider = exports.useContractKitContext = void 0;\nvar contractkit_1 = require(\"@celo/contractkit\");\nvar react_1 = __importStar(require(\"react\"));\nvar connectors_1 = require(\"./connectors\");\nvar constants_1 = require(\"./constants\");\nvar contract_kit_reducer_1 = require(\"./contract-kit-reducer\");\nvar modals_1 = require(\"./modals\");\nvar use_contract_kit_methods_1 = require(\"./use-contract-kit-methods\");\nvar helpers_1 = require(\"./utils/helpers\");\nvar useIsMounted_1 = require(\"./utils/useIsMounted\");\nvar initialState = {\n    connector: new connectors_1.UnauthenticatedConnector(constants_1.Mainnet),\n    connectorInitError: null,\n    dapp: {\n        name: 'Celo dApp',\n        description: 'Celo dApp',\n        url: 'https://celo.org',\n        icon: 'https://celo.org/favicon.ico',\n    },\n    network: constants_1.Mainnet,\n    networks: constants_1.DEFAULT_NETWORKS,\n    pendingActionCount: 0,\n    address: null,\n    connectionCallback: null,\n    feeCurrency: contractkit_1.CeloContract.GoldToken,\n};\nexports.useContractKitContext = (_a = __read(createContractKitContext(), 2), _a[0]), exports.ContextProvider = _a[1];\n// This makes it so we don't have to provide defaults for our context\n// and also so that if our hooks are used outside of the Provider it\n// will throw an error.\nfunction createContractKitContext() {\n    var contractKitContext = react_1.default.createContext(undefined);\n    var useCtx = function () {\n        var c = react_1.default.useContext(contractKitContext);\n        if (!c)\n            throw new Error('Components using the use-contractkit hook must be a child of a ContractKitProvider');\n        return c;\n    };\n    return [useCtx, contractKitContext.Provider];\n}\nvar ContractKitProvider = function (_a) {\n    var _b;\n    var children = _a.children, connectModal = _a.connectModal, actionModal = _a.actionModal, dapp = _a.dapp, _c = _a.network, network = _c === void 0 ? constants_1.Mainnet : _c, _d = _a.networks, networks = _d === void 0 ? constants_1.DEFAULT_NETWORKS : _d, _e = _a.feeCurrency, feeCurrency = _e === void 0 ? contractkit_1.CeloContract.GoldToken : _e;\n    var isMountedRef = (0, useIsMounted_1.useIsMounted)();\n    var previousConfig = (0, react_1.useMemo)(function () { return (0, helpers_1.loadPreviousConfig)(network); }, [network]);\n    var _f = __read((0, react_1.useReducer)(contract_kit_reducer_1.contractKitReducer, __assign(__assign(__assign({}, initialState), previousConfig), { network: previousConfig.network || network, networks: networks, feeCurrency: feeCurrency, dapp: __assign(__assign({}, dapp), { icon: (_b = dapp.icon) !== null && _b !== void 0 ? _b : \"\".concat(dapp.url, \"/favicon.ico\") }) })), 2), state = _f[0], _dispatch = _f[1];\n    var dispatch = (0, react_1.useCallback)(function (type) {\n        var payload = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            payload[_i - 1] = arguments[_i];\n        }\n        if (isMountedRef.current) {\n            _dispatch({ type: type, payload: payload[0] });\n        }\n    }, [isMountedRef]);\n    var methods = (0, use_contract_kit_methods_1.useContractKitMethods)(state, dispatch);\n    (0, react_1.useEffect)(function () {\n        if (connectors_1.CONNECTOR_TYPES[state.connector.type] !== connectors_1.UnauthenticatedConnector) {\n            methods.initConnector(state.connector).catch(function () {\n                // If the connector fails to initialise on mount then we reset.\n                dispatch('destroy');\n            });\n        }\n        /* eslint-disable */\n        // We only want this to run on mount so the deps array is empty.\n    }, []);\n    /* eslint-enable */\n    return (react_1.default.createElement(exports.ContextProvider, { value: [state, dispatch, methods] },\n        react_1.default.createElement(modals_1.ConnectModal, __assign({}, connectModal)),\n        react_1.default.createElement(modals_1.ActionModal, __assign({}, actionModal)),\n        children));\n};\nexports.ContractKitProvider = ContractKitProvider;\n//# sourceMappingURL=contract-kit-provider.js.map"]},"metadata":{},"sourceType":"script"}