{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MultiSigWrapper = void 0;\n\nvar connect_1 = require(\"@celo/connect\");\n\nvar bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\n\nvar BaseWrapper_1 = require(\"./BaseWrapper\");\n/**\n * Contract for handling multisig actions\n */\n\n\nvar MultiSigWrapper =\n/** @class */\nfunction (_super) {\n  __extends(MultiSigWrapper, _super);\n\n  function MultiSigWrapper() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.isowner = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.isOwner);\n    _this.getOwners = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.getOwners);\n    _this.getRequired = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.required, undefined, BaseWrapper_1.valueToBigNumber);\n    _this.getInternalRequired = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.internalRequired, undefined, BaseWrapper_1.valueToBigNumber);\n    _this.totalTransactionCount = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.transactionCount, undefined, BaseWrapper_1.valueToInt);\n    _this.getTransactionCount = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.getTransactionCount, undefined, BaseWrapper_1.valueToInt);\n    _this.replaceOwner = (0, BaseWrapper_1.proxySend)(_this.kit, _this.contract.methods.replaceOwner, (0, BaseWrapper_1.tupleParser)(BaseWrapper_1.stringIdentity, BaseWrapper_1.stringIdentity));\n    return _this;\n  }\n  /**\n   * Allows an owner to submit and confirm a transaction.\n   * If an unexecuted transaction matching `txObject` exists on the multisig, adds a confirmation to that tx ID.\n   * Otherwise, submits the `txObject` to the multisig and add confirmation.\n   * @param index The index of the pending withdrawal to withdraw.\n   */\n\n\n  MultiSigWrapper.prototype.submitOrConfirmTransaction = function (destination, txObject, value) {\n    if (value === void 0) {\n      value = '0';\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var data, transactionCount, transactionId, transaction;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            data = (0, BaseWrapper_1.stringToSolidityBytes)(txObject.encodeABI());\n            return [4\n            /*yield*/\n            , this.contract.methods.getTransactionCount(true, true).call()];\n\n          case 1:\n            transactionCount = _a.sent();\n            transactionId = Number(transactionCount) - 1;\n            _a.label = 2;\n\n          case 2:\n            if (!(transactionId >= 0)) return [3\n            /*break*/\n            , 5];\n            return [4\n            /*yield*/\n            , this.contract.methods.transactions(transactionId).call()];\n\n          case 3:\n            transaction = _a.sent();\n\n            if (transaction.data === data && transaction.destination === destination && transaction.value === value && !transaction.executed) {\n              return [2\n              /*return*/\n              , (0, connect_1.toTransactionObject)(this.kit.connection, this.contract.methods.confirmTransaction(transactionId))];\n            }\n\n            _a.label = 4;\n\n          case 4:\n            transactionId--;\n            return [3\n            /*break*/\n            , 2];\n\n          case 5:\n            return [2\n            /*return*/\n            , (0, connect_1.toTransactionObject)(this.kit.connection, this.contract.methods.submitTransaction(destination, value, data))];\n        }\n      });\n    });\n  };\n\n  MultiSigWrapper.prototype.getTransactionDataByContent = function (destination, txo, value) {\n    if (value === void 0) {\n      value = 0;\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var data, transactionCount, transactionId, tx;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            data = (0, BaseWrapper_1.stringToSolidityBytes)(txo.encodeABI());\n            return [4\n            /*yield*/\n            , this.getTransactionCount(true, true) // reverse order for recency\n            ];\n\n          case 1:\n            transactionCount = _a.sent();\n            transactionId = transactionCount - 1;\n            _a.label = 2;\n\n          case 2:\n            if (!(transactionId >= 0)) return [3\n            /*break*/\n            , 5];\n            return [4\n            /*yield*/\n            , this.getTransaction(transactionId)];\n\n          case 3:\n            tx = _a.sent();\n\n            if (tx.data === data && tx.destination === destination && tx.value.isEqualTo(value)) {\n              return [2\n              /*return*/\n              , tx];\n            }\n\n            _a.label = 4;\n\n          case 4:\n            transactionId--;\n            return [3\n            /*break*/\n            , 2];\n\n          case 5:\n            return [2\n            /*return*/\n            , undefined];\n        }\n      });\n    });\n  };\n\n  MultiSigWrapper.prototype.getTransaction = function (i) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, destination, value, data, executed, confirmations, _i, _b, e;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.contract.methods.transactions(i).call()];\n\n          case 1:\n            _a = _c.sent(), destination = _a.destination, value = _a.value, data = _a.data, executed = _a.executed;\n            confirmations = [];\n            _i = 0;\n            return [4\n            /*yield*/\n            , this.getOwners()];\n\n          case 2:\n            _b = _c.sent();\n            _c.label = 3;\n\n          case 3:\n            if (!(_i < _b.length)) return [3\n            /*break*/\n            , 6];\n            e = _b[_i];\n            return [4\n            /*yield*/\n            , this.contract.methods.confirmations(i, e).call()];\n\n          case 4:\n            if (_c.sent()) {\n              confirmations.push(e);\n            }\n\n            _c.label = 5;\n\n          case 5:\n            _i++;\n            return [3\n            /*break*/\n            , 3];\n\n          case 6:\n            return [2\n            /*return*/\n            , {\n              destination: destination,\n              data: data,\n              executed: executed,\n              confirmations: confirmations,\n              value: new bignumber_js_1.default(value)\n            }];\n        }\n      });\n    });\n  };\n\n  MultiSigWrapper.prototype.getTransactions = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var txcount, res, i, _a, _b;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.totalTransactionCount()];\n\n          case 1:\n            txcount = _c.sent();\n            res = [];\n            i = 0;\n            _c.label = 2;\n\n          case 2:\n            if (!(i < txcount)) return [3\n            /*break*/\n            , 5];\n            _b = (_a = res).push;\n            return [4\n            /*yield*/\n            , this.getTransaction(i)];\n\n          case 3:\n            _b.apply(_a, [_c.sent()]);\n\n            _c.label = 4;\n\n          case 4:\n            i++;\n            return [3\n            /*break*/\n            , 2];\n\n          case 5:\n            return [2\n            /*return*/\n            , res];\n        }\n      });\n    });\n  };\n\n  return MultiSigWrapper;\n}(BaseWrapper_1.BaseWrapper);\n\nexports.MultiSigWrapper = MultiSigWrapper;","map":{"version":3,"sources":["../../src/wrappers/MultiSig.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MultiSigWrapper = void 0;\nvar connect_1 = require(\"@celo/connect\");\nvar bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\nvar BaseWrapper_1 = require(\"./BaseWrapper\");\n/**\n * Contract for handling multisig actions\n */\nvar MultiSigWrapper = /** @class */ (function (_super) {\n    __extends(MultiSigWrapper, _super);\n    function MultiSigWrapper() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.isowner = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.isOwner);\n        _this.getOwners = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.getOwners);\n        _this.getRequired = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.required, undefined, BaseWrapper_1.valueToBigNumber);\n        _this.getInternalRequired = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.internalRequired, undefined, BaseWrapper_1.valueToBigNumber);\n        _this.totalTransactionCount = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.transactionCount, undefined, BaseWrapper_1.valueToInt);\n        _this.getTransactionCount = (0, BaseWrapper_1.proxyCall)(_this.contract.methods.getTransactionCount, undefined, BaseWrapper_1.valueToInt);\n        _this.replaceOwner = (0, BaseWrapper_1.proxySend)(_this.kit, _this.contract.methods.replaceOwner, (0, BaseWrapper_1.tupleParser)(BaseWrapper_1.stringIdentity, BaseWrapper_1.stringIdentity));\n        return _this;\n    }\n    /**\n     * Allows an owner to submit and confirm a transaction.\n     * If an unexecuted transaction matching `txObject` exists on the multisig, adds a confirmation to that tx ID.\n     * Otherwise, submits the `txObject` to the multisig and add confirmation.\n     * @param index The index of the pending withdrawal to withdraw.\n     */\n    MultiSigWrapper.prototype.submitOrConfirmTransaction = function (destination, txObject, value) {\n        if (value === void 0) { value = '0'; }\n        return __awaiter(this, void 0, void 0, function () {\n            var data, transactionCount, transactionId, transaction;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        data = (0, BaseWrapper_1.stringToSolidityBytes)(txObject.encodeABI());\n                        return [4 /*yield*/, this.contract.methods.getTransactionCount(true, true).call()];\n                    case 1:\n                        transactionCount = _a.sent();\n                        transactionId = Number(transactionCount) - 1;\n                        _a.label = 2;\n                    case 2:\n                        if (!(transactionId >= 0)) return [3 /*break*/, 5];\n                        return [4 /*yield*/, this.contract.methods.transactions(transactionId).call()];\n                    case 3:\n                        transaction = _a.sent();\n                        if (transaction.data === data &&\n                            transaction.destination === destination &&\n                            transaction.value === value &&\n                            !transaction.executed) {\n                            return [2 /*return*/, (0, connect_1.toTransactionObject)(this.kit.connection, this.contract.methods.confirmTransaction(transactionId))];\n                        }\n                        _a.label = 4;\n                    case 4:\n                        transactionId--;\n                        return [3 /*break*/, 2];\n                    case 5: return [2 /*return*/, (0, connect_1.toTransactionObject)(this.kit.connection, this.contract.methods.submitTransaction(destination, value, data))];\n                }\n            });\n        });\n    };\n    MultiSigWrapper.prototype.getTransactionDataByContent = function (destination, txo, value) {\n        if (value === void 0) { value = 0; }\n        return __awaiter(this, void 0, void 0, function () {\n            var data, transactionCount, transactionId, tx;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        data = (0, BaseWrapper_1.stringToSolidityBytes)(txo.encodeABI());\n                        return [4 /*yield*/, this.getTransactionCount(true, true)\n                            // reverse order for recency\n                        ];\n                    case 1:\n                        transactionCount = _a.sent();\n                        transactionId = transactionCount - 1;\n                        _a.label = 2;\n                    case 2:\n                        if (!(transactionId >= 0)) return [3 /*break*/, 5];\n                        return [4 /*yield*/, this.getTransaction(transactionId)];\n                    case 3:\n                        tx = _a.sent();\n                        if (tx.data === data && tx.destination === destination && tx.value.isEqualTo(value)) {\n                            return [2 /*return*/, tx];\n                        }\n                        _a.label = 4;\n                    case 4:\n                        transactionId--;\n                        return [3 /*break*/, 2];\n                    case 5: return [2 /*return*/, undefined];\n                }\n            });\n        });\n    };\n    MultiSigWrapper.prototype.getTransaction = function (i) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, destination, value, data, executed, confirmations, _i, _b, e;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0: return [4 /*yield*/, this.contract.methods\n                            .transactions(i)\n                            .call()];\n                    case 1:\n                        _a = _c.sent(), destination = _a.destination, value = _a.value, data = _a.data, executed = _a.executed;\n                        confirmations = [];\n                        _i = 0;\n                        return [4 /*yield*/, this.getOwners()];\n                    case 2:\n                        _b = _c.sent();\n                        _c.label = 3;\n                    case 3:\n                        if (!(_i < _b.length)) return [3 /*break*/, 6];\n                        e = _b[_i];\n                        return [4 /*yield*/, this.contract.methods.confirmations(i, e).call()];\n                    case 4:\n                        if (_c.sent()) {\n                            confirmations.push(e);\n                        }\n                        _c.label = 5;\n                    case 5:\n                        _i++;\n                        return [3 /*break*/, 3];\n                    case 6: return [2 /*return*/, {\n                            destination: destination,\n                            data: data,\n                            executed: executed,\n                            confirmations: confirmations,\n                            value: new bignumber_js_1.default(value),\n                        }];\n                }\n            });\n        });\n    };\n    MultiSigWrapper.prototype.getTransactions = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var txcount, res, i, _a, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0: return [4 /*yield*/, this.totalTransactionCount()];\n                    case 1:\n                        txcount = _c.sent();\n                        res = [];\n                        i = 0;\n                        _c.label = 2;\n                    case 2:\n                        if (!(i < txcount)) return [3 /*break*/, 5];\n                        _b = (_a = res).push;\n                        return [4 /*yield*/, this.getTransaction(i)];\n                    case 3:\n                        _b.apply(_a, [_c.sent()]);\n                        _c.label = 4;\n                    case 4:\n                        i++;\n                        return [3 /*break*/, 2];\n                    case 5: return [2 /*return*/, res];\n                }\n            });\n        });\n    };\n    return MultiSigWrapper;\n}(BaseWrapper_1.BaseWrapper));\nexports.MultiSigWrapper = MultiSigWrapper;\n//# sourceMappingURL=MultiSig.js.map"]},"metadata":{},"sourceType":"script"}